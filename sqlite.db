--
-- Файл сгенерирован с помощью SQLiteStudio v3.4.3 в Пн мар 13 05:26:05 2023
--
-- Использованная кодировка текста: System
--
PRAGMA foreign_keys = off;
BEGIN TRANSACTION;

-- Таблица: Заказы
DROP TABLE IF EXISTS Заказы;
CREATE TABLE IF NOT EXISTS Заказы (
ID_заказа INT PRIMARY KEY NOT NULL,
ID_покупателя INT NOT NULL,
ID_товара INT NOT NULL,
Дата_заказа DATE NOT NULL,
Количество_товара INT NOT NULL,
FOREIGN KEY (ID_покупателя) REFERENCES Покупатель(ID_покупателя),
FOREIGN KEY (ID_товара) REFERENCES Товары(ID_товара)
);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (1, 2, 38, '2022-01-01', 1);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (2, 1, 40, '2022-01-02', 10);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (3, 3, 40, '2022-01-03', 2);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (4, 3, 42, '2022-01-03', 1);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (5, 1, 42, '2022-01-04', 1);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (6, 3, 40, '2022-01-05', 2);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (7, 1, 38, '2022-01-06', 5);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (8, 1, 40, '2022-01-07', 2);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (9, 2, 38, '2022-03-12', 2);
INSERT INTO Заказы (ID_заказа, ID_покупателя, ID_товара, Дата_заказа, Количество_товара) VALUES (10, 3, 42, '2022-03-12', 10);

-- Таблица: Покупатель
DROP TABLE IF EXISTS Покупатель;
CREATE TABLE IF NOT EXISTS Покупатель(
ID_покупателя INT PRIMARY KEY NOT NULL,
ФИО_покупателя nchar(50) NOT NULL,
[E-mail] nchar(50) NOT NULL,
Телефон_покупателя nchar(15) NOT NULL,
Адрес_покупателя nchar(100) NOT NULL
);
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (1, 'Черных Е. М', 'chernich@mail.ru', '+79278885423', 'г. Москва, ул. Пушкина, д.45, кв.34');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (2, 'Браго А. Л', 'bargoh@mail.ru', '+79278883212', 'г. Москва, ул. Есенина, д.40, кв.32');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (3, 'Сорокина Е. Л.', 'siirifjssh@mail.ru', '+79278351623', 'г. Москва, ул. Летчиков, д.332, кв.1234');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (4, 'Еленова М. Г', 'ueuwidh@mail.ru', '+79278885421', 'г. Москва, ул. Тургенева, д.1, кв.342');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (5, 'Подольский М. Н', 'mnhdw@mail.ru', '+79372616353', 'г. Подольск, ул. Главная, д.64, кв.1');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (6, 'АОООАО Г. Л.', 'cfjjdjwh@mail.ru', '+79278883209', 'г. Москва, ул. Щипок, д.56, кв.134');
INSERT INTO Покупатель (ID_покупателя, ФИО_покупателя, "E-mail", Телефон_покупателя, Адрес_покупателя) VALUES (7, 'Смирнов Г. Л.', 'Smirnovh@mail.ru', '+79278885213', 'г. Москва, ул. Кулера, д.392, кв.343');

-- Таблица: Товары
DROP TABLE IF EXISTS Товары;
CREATE TABLE IF NOT EXISTS Товары(
ID_товара INT PRIMARY KEY NOT NULL,
Название_товара nchar(50) NOT NULL,
Категория_товара nchar(30) NOT NULL,
Стоимость_товара Money NOT NULL,
Количество_товара INT NOT NULL
);
INSERT INTO Товары (ID_товара, Название_товара, Категория_товара, Стоимость_товара, Количество_товара) VALUES (38, 'Холодильник BOCSH', 'Холодильники', 40000, 998);
INSERT INTO Товары (ID_товара, Название_товара, Категория_товара, Стоимость_товара, Количество_товара) VALUES (40, 'Микроволновая печь SHARP', 'Микроволновые печи', 3500, 1500);
INSERT INTO Товары (ID_товара, Название_товара, Категория_товара, Стоимость_товара, Количество_товара) VALUES (42, 'Телевизор Samsung', 'Телевизоры', 39500, 990);

-- Триггер: Количество_товара
DROP TRIGGER IF EXISTS Количество_товара;
CREATE TRIGGER IF NOT EXISTS Количество_товара
AFTER INSERT ON Заказы
BEGIN
  UPDATE Товары
  SET Количество_товара = Количество_товара - NEW.Количество_товара
  WHERE ID_товара = NEW.ID_товара;
END;

COMMIT TRANSACTION;
PRAGMA foreign_keys = on;
